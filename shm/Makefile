
# -------------- 核心配置项（新增文件无需修改这里） --------------
# CUDA 编译器
NVCC = gcc
# 编译选项：C++11 标准、开启警告信息
NVCC_FLAGS = -std=c++11

# -------------- 自动化变量（自动扫描，无需手动添加） --------------
# 1. 自动扫描当前目录下所有 .cu 源文件
CUDA_SRCS = $(wildcard *.c)

# 2. 自动将 .cu 后缀替换为可执行文件名称（无需手动写 TARGET1、TARGET2）
# 例如：test_ipc_handle.cu → test_ipc_handle
TARGETS = $(patsubst %.c, %, $(CUDA_SRCS))

# -------------- 默认目标（执行 make 时自动编译所有 .cu 文件） --------------
all: $(TARGETS)

# -------------- 通用编译规则（匹配所有 .cu → 可执行文件，新增文件自动适配） --------------
# 规则说明：任意一个可执行文件（%），依赖对应的 .cu 文件（%.cu）
%: %.c
	$(NVCC) $(NVCC_FLAGS) -o $@ $<

# -------------- 清理规则（自动删除所有生成的可执行文件） --------------
clean:
	# 删除所有自动生成的可执行文件（-f 忽略不存在的文件，不报错）
	rm -f $(TARGETS)
	# 可选：删除编译过程中可能生成的临时 .o 文件
	rm -f *.o
